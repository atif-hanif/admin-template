<!DOCTYPE html>
<html lang="en">

<head>
	<title>Full Calendar | Nova Admin Template</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="shortcut icon" type="image/x-icon" href="images/favicon.ico">
	<link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
	<link href="vendor/fontawesome/css/all.min.css" rel="stylesheet">
	<link href="vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
	<link href="css/fonts.css" rel="stylesheet">
	<link href="css/style.css" rel="stylesheet">
	<link href="css/responsive.css" rel="stylesheet">
</head>

<body class="app">
	<!-- Start Side Nav -->
	<div class="sidebar">
		<div class="sidebar-inner">
			<div class="sidebar-logo">
				<div class="d-flex align-items-center flex-nowrap">
					<a class="sidebar-link text-decoration-none nav-logo" href="index.html">
						<div class="d-flex align-items-center flex-nowrap">
							<div class="logo-sm">
								<img src="images/icon-logo.png" alt="logo" class="icon-logo">
							</div>
							<img src="images/nova-logo.png" alt="logo" class="main-logo">
						</div>
					</a>
					<div class="mobile-toggle sidebar-toggle mt-n2">
						<a href="#" class="text-decoration-none"> <i class="far fa-times-circle"></i> </a>
					</div>
				</div>
			</div>
			<ul class="sidebar-menu scrollable position-relative">
				<li class="nav-item">
					<a class="nav-link" href="index.html">
						<i class='bx bxs-dashboard'></i>
						<span class="title">Dashboard</span>
					</a>
				</li>
				<li class="nav-item dropdown open">
					<a class="nav-link active" href="#">
						<i class='bx bxl-bootstrap'></i>
						<span class="title">Bootstrap</span>
						<span class="arrow">
							<i class="fas fa-angle-right"></i>
						</span>
					</a>
					<ul class="dropdown-menu">
						<li>
							<a class="sidebar-link dropdown-item" href="accordion.html">Accordion</a>
						</li>
						<li>
							<a class="sidebar-link dropdown-item" href="alerts.html">Alerts</a>
						</li>
						<li>
							<a class="sidebar-link dropdown-item" href="badges.html">Badges</a>
						</li>
						<li>
							<a class="sidebar-link dropdown-item" href="breadcrumb.html">Breadcrumb</a>
						</li>
						<li>
							<a class="sidebar-link dropdown-item" href="buttons.html">Buttons</a>
						</li>
						<li>
							<a class="sidebar-link dropdown-item" href="button-group.html">Button Group</a>
						</li>
						<li>
							<a class="sidebar-link dropdown-item" href="cards.html">Cards</a>
						</li>
						<li>
							<a class="sidebar-link dropdown-item" href="carousel.html">Carousel</a>
						</li>
						<li>
							<a class="sidebar-link dropdown-item" href="collapse.html">Collapse</a>
						</li>
                        <li>
							<a class="sidebar-link dropdown-item" href="dropdown.html">Dropdown</a>
						</li>
                        <li>
							<a class="sidebar-link sub-menu dropdown-item" href="forms.html">Forms</a>
						</li>
					</ul>
				</li>
			</ul>
		</div>
	</div>
	<!-- End Side Nav -->

	<!-- Start Main -->
	<div class="container-wide">
		<header class="header">
			<nav class="navbar navbar-expand-md navbar-dark top-nav py-3">
				<ul class="navbar-nav me-auto">
					<li class="nav-item active">
						<a id="sidebar-toggle" class="sidebar-toggle nav-link" href="#">
							<i class="fa-solid fa-chevrons-left"></i>
						</a>
					</li>
				</ul>
				<ul class="navbar-nav d-none d-md-flex align-items-center ml-auto">
					<li class="nav-item">
						<div class="searchbar">
							<input class="search_input" type="text" name="" placeholder="Search">
							<a href="#" class="search_icon">
								<i class="fa-solid fa-magnifying-glass search-icon"></i>
							</a>
						</div>
					</li>
					<li class="nav-item">
						<a class="nav-link" href="#" onclick="toggleFullScreen();">
							<i class="fa-solid fa-expand full-screen-icon" id="fullscreen"></i>
						</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" href="#" data-toggle="tooltip" data-placement="bottom" title="Email">
							<i class="fa-solid fa-envelope envelope-icon"></i>
						</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" href="#">
							<i class="fa-solid fa-circle-half-stroke mode-icon"></i>
						</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" href="#" data-toggle="modal" data-target="#chat">
							<i class="fa-solid fa-message chat-icon"></i>
						</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" href="#" data-toggle="modal" data-target="#notification">
							<i class="fa-solid fa-bell notification-icon"></i>
						</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" href="#">
							<i class="fa-solid fa-arrow-right-from-bracket logout-icon"></i>
						</a>
					</li>
				</ul>
			</nav>
		</header>

		<div class="container-fluid main-content">
			<div class="row">
				<div class="col-sm-12">
					<div class="card breadcrumb-card">
						<nav aria-label="breadcrumb" class="second">
							<ol class="breadcrumb indigo lighten-6 first shadow-lg px-md-4 mb-0">
								<li class="breadcrumb-item font-weight-bold">
									<a class="black-text text-uppercase " href="calendar.html">
										<span class="align-middle">Calendar</span>
									</a>
								</li>
							</ol>
						</nav>
					</div>
				</div>
			</div>

			<div class="row mt-sm-40 mt-md-40 mt-lg-40 mt-xl-40">
				<div class="col-sm-12">
					<div class="card mb-3 mb-sm-3 mb-md-3 mb-lg-0">
						<div class="card-header custom-card-header">
							<h5 class="mb-0">Calendar</h5>
						</div>
						<div class="card-body">
                            <div class="row">
                                <div class="col-xl-3">
									<div class="card h-100">
										<div class="card-body">
											<button class="btn btn-blue d-block mx-auto" type="button" data-toggle="modal" data-target="#add_event">Create New Event</button>
											<div id="external-events" class="mt-3">
												<p><strong>Draggable Events</strong></p>
												<p class="fc-event text-white px-2 py-1 rounded">My Event 1</p>
												<p class="fc-event text-white px-2 py-1 rounded">My Event 2</p>
												<p class="fc-event text-white px-2 py-1 rounded">My Event 3</p>
												<p class="fc-event text-white px-2 py-1 rounded">My Event 4</p>
												<p class="fc-event text-white px-2 py-1 rounded">My Event 5</p>
												<div class="form-group form-check mt-3">
													<label class="form-check-label">
													  <input class="form-check-input" type="checkbox" id="drop-remove"> Remove after drop
													</label>
												</div>
											</div>
										</div>
									</div>
                                </div>
                                <div class="col-xl-9 mt-3 mt-xl-0">
									<div class="card">
										<div class="card-body">
											<div id="calendar-container">
												<div id="calendar"></div>
											</div>
										</div>
                                    </div>
                                </div>
                            </div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- End Main -->

	<!-- Start Footer -->
	<footer class="footer">
		<div class="copyrights">
			<p class="text-center">© Copyrights 2023. All Rights Reserved.</p>
		</div>
	</footer>
	<!-- End Footer -->

	<!-- Start Add Modal -->
	<div class="modal fade edit-form" id="add_event">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<h4 class="modal-title">Add Event</h4>
					<button type="button" class="close" data-dismiss="modal">&times;</button>
				</div>
				
				<div class="modal-body">
					<form id="myForm">
						<div class="modal-body">
							<div class="alert alert-danger " role="alert" id="danger_alert" style="display: none;">
								End date should be greater than start date.
							  </div>
							<div class="form-group">
								<label for="event_title">Event name <span class="text-danger">*</span></label>
								<input type="text" class="form-control" id="event_title" placeholder="Enter event name" required>
							</div>
							<div class="form-group">
								<label for="start_date">Start date <span class="text-danger">*</span></label>
								<input type="date" class="form-control" id="start_date" placeholder="start_date" required>
							</div>
							<div class="form-group">
								<label for="end_date">End date - <small class="text-muted">Optional</small></label>
								<input type="date" class="form-control" id="end_date" placeholder="end_date">
							</div>
							<div class="form-group">
								<label for="event_color">Color</label>
								<input type="color" class="form-control" id="event_color" value="#3788d8">
							  </div>
						</div>
						<div class="modal-footer text-right">
							<button type="submit" class="btn btn-blue" id="submit_button">Submit</button>
						  </div>
					</form>
				</div>
			</div>
		</div>
	</div>
	<!-- End Add Modal -->

	<!-- Start Chat Modal -->
	<div class="modal right fade chat-modal" id="chat">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<h4 class="modal-title">Chat</h4>
					<button type="button" class="close" data-dismiss="modal">×</button>
				</div>
				<div class="modal-body">
					<ul class="contacts">
						<li class="name-first-letter">A</li>
						<li class="dlab-chat-user">
							<div class="d-flex bd-highlight">
								<div class="img_cont">
									<img src="images/avatar/user-1.webp" class="rounded-circle user_img" alt="Avatar">
									<span class="online_icon"></span>
								</div>
								<div class="user_info">
									<span>Alexander</span>
									<p>is online</p>
								</div>
							</div>
						</li>
						<li class="dlab-chat-user">
							<div class="d-flex bd-highlight">
								<div class="img_cont">
									<img src="images/avatar/user-7.webp" class="rounded-circle user_img" alt="Avatar">
									<span class="online_icon offline"></span>
								</div>
								<div class="user_info">
									<span>Amelia</span>
									<p>7 mins ago</p>
								</div>
							</div>
						</li>
						<li class="name-first-letter">B</li>
						<li class="dlab-chat-user">
							<div class="d-flex bd-highlight">
								<div class="img_cont">
									<img src="images/avatar/user-2.webp" class="rounded-circle user_img" alt="Avatar">
									<span class="online_icon"></span>
								</div>
								<div class="user_info">
									<span>Bradley</span>
									<p>is online</p>
								</div>
							</div>
						</li>
						<li class="dlab-chat-user">
							<div class="d-flex bd-highlight">
								<div class="img_cont">
									<img src="images/avatar/user-8.webp" class="rounded-circle user_img" alt="Avatar">
									<span class="online_icon offline"></span>
								</div>
								<div class="user_info">
									<span>Bella</span>
									<p>left 50 mins ago</p>
								</div>
							</div>
						</li>
						<li class="name-first-letter">C</li>
						<li class="dlab-chat-user">
							<div class="d-flex bd-highlight">
								<div class="img_cont">
									<img src="images/avatar/user-3.webp" class="rounded-circle user_img" alt="Avatar">
									<span class="online_icon"></span>
								</div>
								<div class="user_info">
									<span>Charles</span>
									<p>is online</p>
								</div>
							</div>
						</li>
						<li class="dlab-chat-user">
							<div class="d-flex bd-highlight">
								<div class="img_cont">
									<img src="images/avatar/user-9.webp" class="rounded-circle user_img" alt="Avatar">
									<span class="online_icon offline"></span>
								</div>
								<div class="user_info">
									<span>Camila</span>
									<p>left 30 mins ago</p>
								</div>
							</div>
						</li>
						<li class="name-first-letter">D</li>
						<li class="dlab-chat-user">
							<div class="d-flex bd-highlight">
								<div class="img_cont">
									<img src="images/avatar/user-4.webp" class="rounded-circle user_img" alt="Avatar">
									<span class="online_icon offline"></span>
								</div>
								<div class="user_info">
									<span>David</span>
									<p> 50 mins ago</p>
								</div>
							</div>
						</li>
						<li class="dlab-chat-user">
							<div class="d-flex bd-highlight">
								<div class="img_cont">
									<img src="images/avatar/user-10.webp" class="rounded-circle user_img" alt="Avatar">
									<span class="online_icon"></span>
								</div>
								<div class="user_info">
									<span>Daisy</span>
									<p>is online</p>
								</div>
							</div>
						</li>
						<li class="name-first-letter">E</li>
						<li class="dlab-chat-user">
							<div class="d-flex bd-highlight">
								<div class="img_cont">
									<img src="images/avatar/user-5.webp" class="rounded-circle user_img" alt="Avatar">
									<span class="online_icon offline"></span>
								</div>
								<div class="user_info">
									<span>Ethan</span>
									<p>left 7 mins ago</p>
								</div>
							</div>
						</li>
						<li class="dlab-chat-user">
							<div class="d-flex bd-highlight">
								<div class="img_cont">
									<img src="images/avatar/user-11.webp" class="rounded-circle user_img" alt="Avatar">
									<span class="online_icon"></span>
								</div>
								<div class="user_info">
									<span>Emma</span>
									<p>is online</p>
								</div>
							</div>
						</li>
						<li class="name-first-letter">F</li>
						<li class="dlab-chat-user">
							<div class="d-flex bd-highlight">
								<div class="img_cont">
									<img src="images/avatar/user-6.webp" class="rounded-circle user_img" alt="Avatar">
									<span class="online_icon offline"></span>
								</div>
								<div class="user_info">
									<span>Finn</span>
									<p>left 30 mins ago</p>
								</div>
							</div>
						</li>
						<li class="dlab-chat-user">
							<div class="d-flex bd-highlight">
								<div class="img_cont">
									<img src="images/avatar/user-12.webp" class="rounded-circle user_img" alt="Avatar">
									<span class="online_icon offline"></span>
								</div>
								<div class="user_info">
									<span>Floara</span>
									<p>left 50 mins ago</p>
								</div>
							</div>
						</li>
					</ul>
				</div>
			</div>
		</div>
	</div>
	<!-- End Chat Modal -->

	<!-- Start Notification Modal -->
	<div class="modal right fade" id="notification">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header notification-header">
					<h4 class="modal-title notification-title">Notification</h4>
					<button type="button" class="close" data-dismiss="modal">×</button>
				</div>
				<div class="modal-body">
					<ul class="notification-nav">
						<li class="nav-item">
							<a href="#" class="nav-link d-flex">
								<div class="timeline-panel">
									<div class="media-img media-info-one"> MK </div>
									<div class="media-body">
										<h6 class="mb-0">Martin send you photo</h6>
										<small class="d-block date-time">01 October 2021 - 02:26 PM</small>
									</div>
								</div>
							</a>
						</li>
						<li class="nav-item">
							<a href="#" class="nav-link d-flex">
								<div class="timeline-panel">
									<div class="media-img media-info-two"> KG </div>
									<div class="media-body">
										<h6 class="mb-0">Karter created task</h6>
										<small class="d-block date-time">01 October 2021 - 05:00 PM</small>
									</div>
								</div>
							</a>
						</li>
						<li class="nav-item">
							<a href="#" class="nav-link d-flex">
								<div class="timeline-panel">
									<div class="media-img media-info-three"> JA </div>
									<div class="media-body">
										<h6 class="mb-0">Jennifer sent an email</h6>
										<small class="d-block date-time">02 October 2021 - 10:00 AM</small>
									</div>
								</div>
							</a>
						</li>
						<li class="nav-item">
							<a href="#" class="nav-link d-flex">
								<div class="timeline-panel">
									<div class="media-img media-info-four"> EW </div>
									<div class="media-body">
										<h6 class="mb-0">Emma added a photo</h6>
										<small class="d-block date-time">02 October 2021 - 05:00 PM</small>
									</div>
								</div>
							</a>
						</li>
						<li class="nav-item">
							<a href="#" class="nav-link d-flex">
								<div class="timeline-panel">
									<div class="media-img media-info-one"> JC </div>
									<div class="media-body">
										<h6 class="mb-0">Jackie send you photo</h6>
										<small class="d-block date-time">03 October 2021 - 02:30 PM</small>
									</div>
								</div>
							</a>
						</li>
						<li class="nav-item">
							<a href="#" class="nav-link d-flex">
								<div class="timeline-panel">
									<div class="media-img media-info-two"> SB </div>
									<div class="media-body">
										<h6 class="mb-0">Shane created task</h6>
										<small class="d-block date-time">03 October 2021 - 08:00 PM</small>
									</div>
								</div>
							</a>
						</li>
						<li class="nav-item">
							<a href="#" class="nav-link d-flex">
								<div class="timeline-panel">
									<div class="media-img media-info-three"> AD </div>
									<div class="media-body">
										<h6 class="mb-0">Alexa sent an email</h6>
										<small class="d-block date-time">04 October 2021 - 10:00 AM</small>
									</div>
								</div>
							</a>
						</li>
						<li class="nav-item">
							<a href="#" class="nav-link d-flex">
								<div class="timeline-panel">
									<div class="media-img media-info-four"> ZS </div>
									<div class="media-body">
										<h6 class="mb-0">Zoe added a photo</h6>
										<small class="d-block date-time">04 October 2021 - 05:00 PM</small>
									</div>
								</div>
							</a>
						</li>
						<li class="nav-item">
							<a href="#" class="nav-link d-flex">
								<div class="timeline-panel">
									<div class="media-img media-info-one"> MK </div>
									<div class="media-body">
										<h6 class="mb-0">Martin send you photo</h6>
										<small class="d-block date-time">01 October 2021 - 02:26 PM</small>
									</div>
								</div>
							</a>
						</li>
						<li class="nav-item">
							<a href="#" class="nav-link d-flex">
								<div class="timeline-panel">
									<div class="media-img media-info-two"> KG </div>
									<div class="media-body">
										<h6 class="mb-0">Karter created task</h6>
										<small class="d-block date-time">01 October 2021 - 05:00 PM</small>
									</div>
								</div>
							</a>
						</li>
						<li class="nav-item">
							<a href="#" class="nav-link d-flex">
								<div class="timeline-panel">
									<div class="media-img media-info-three"> JA </div>
									<div class="media-body">
										<h6 class="mb-0">Jennifer sent an email</h6>
										<small class="d-block date-time">02 October 2021 - 10:00 AM</small>
									</div>
								</div>
							</a>
						</li>
						<li class="nav-item">
							<a href="#" class="nav-link d-flex">
								<div class="timeline-panel">
									<div class="media-img media-info-four"> EW </div>
									<div class="media-body">
										<h6 class="mb-0">Emma added a photo</h6>
										<small class="d-block date-time">02 October 2021 - 05:00 PM</small>
									</div>
								</div>
							</a>
						</li>
					</ul>
				</div>
				<div class="modal-footer">
					<a href="#" class="btn btn-blue btn-lg d-block mx-auto">View all notifications</a>
				</div>
			</div>
		</div>
	</div>
	<!-- End Notification Modal -->

	<!-- Start Back to Top -->
	<a id="back-to-top" href="#" class="btn btn-primary btn-blue btn-lg back-to-top" role="button">
		<i class="fas fa-chevron-up"></i>
	</a>
	<!-- End Back to Top -->

	<!-- Scripts -->  
	<script src="vendor/jquery/jquery-3.6.0.min.js"></script>
	<script src="vendor/moment/moment.js"></script>
	<script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="vendor/fullcalendar/dist/index.global.min.js"></script>
	<script src="vendor/uuidv4/uuidv4.min.js"></script>
	<script src="js/script.js"></script>

    <script> 
		document.addEventListener('DOMContentLoaded', function () {
			var Calendar = FullCalendar.Calendar;
			var Draggable = FullCalendar.Draggable;

			var containerEl = document.getElementById('external-events');
			var calendarEl = document.getElementById('calendar');
			var checkbox = document.getElementById('drop-remove');
			const eventModal = new bootstrap.Modal(document.getElementById('add_event'));
			const dangerAlert = document.getElementById('danger_alert');
			const close = document.querySelector('.btn-close');
		
			new Draggable(containerEl, {
				itemSelector: '.fc-event',
				eventData: function(eventEl) {
					return {
						title: eventEl.innerText
					};
				}
			});

			const myEvents = JSON.parse(localStorage.getItem('events')) || [
			{
				id: uuidv4(),
				title: 'Meeting', 
				start: '2024-02-11',
				allDay: true, 
				editable: false,
				color: 'red',
			},
			{
				id: uuidv4(),
				title: 'Conference',
				start: '2024-03-17',
				end: '2024-03-21',
				allDay: false, 
				editable: false,
				color: 'green',
			},
			{
				id: uuidv4(),
				title: 'Event',
				start: '2024-02-22',
				end: '2024-02-24',
				allDay: false, 
				editable: false,
				color: 'orange',
			},
		];

			const calendar = new FullCalendar.Calendar(calendarEl, {
				headerToolbar: {
					left: 'prev,next today',
					center: 'title',
					right: 'dayGridMonth,timeGridWeek,timeGridDay,listWeek'
				},
				droppable: true,
				allDay: true,
				editable: true,
				selectable: true,
				unselectAuto: true,
				displayEventTime: false,
				events: myEvents,
				drop: function(info) {
					if (checkbox.checked) {
						info.draggedEl.parentNode.removeChild(info.draggedEl);
					}
				},

				eventRender: function(info) {
					info.el.addEventListener('contextmenu', function(e) {
						e.preventDefault();
						let existingMenu = document.querySelector('.context-menu');
						existingMenu && existingMenu.remove();
						let menu = document.createElement('div');
						menu.className = 'context-menu';
						menu.innerHTML = `<ul>
						<li><i class="fas fa-edit"></i>Edit</li>
						<li><i class="fas fa-trash-alt"></i>Delete</li>
						</ul>`;

						const eventIndex = myEvents.findIndex(event => event.id === info.event.id);

						document.body.appendChild(menu);
						menu.style.top = e.pageY + 'px';
						menu.style.left = e.pageX + 'px';

						// Edit context menu

						menu.querySelector('li:first-child').addEventListener('click', function() {
							menu.remove();

							const editModal = new bootstrap.Modal(document.getElementById('add_event'));
							const modalTitle = document.getElementById('modal-title');
							const titleInput = document.getElementById('event_title');
							const startDateInput = document.getElementById('start_date');
							const endDateInput = document.getElementById('end_date');
							const colorInput = document.getElementById('event_color');
							const submitButton = document.getElementById('submit_button');
							const cancelButton = document.getElementById('cancel-button');
							modalTitle.innerHTML = 'Edit Event';
							titleInput.value = info.event.title;
							startDateInput.value = moment(info.event.start).format('YYYY-MM-DD');
							endDateInput.value = moment(info.event.end, 'YYYY-MM-DD').subtract(1, 'day').format('YYYY-MM-DD');
							colorInput.value = info.event.backgroundColor;
							submitButton.innerHTML = 'Save Changes';

							editModal.show();

							submitButton.classList.remove('btn-blue')
							submitButton.classList.add('btn-success')

							// Edit button

							submitButton.addEventListener('click', function() {
								const updatedEvents = {
									id: info.event.id,
									title: titleInput.value,
									start: startDateInput.value,
									end: moment(endDateInput.value, 'YYYY-MM-DD').add(1, 'day').format('YYYY-MM-DD'),
									backgroundColor: colorInput.value
								}

								if ( updatedEvents.end <= updatedEvents.start) { // add if statement to check end date
									dangerAlert.style.display = 'block';
									return;
								}
							
								const eventIndex = myEvents.findIndex(event => event.id === updatedEvents.id);
								myEvents.splice(eventIndex, 1, updatedEvents);
							
								localStorage.setItem('events', JSON.stringify(myEvents));
							
								// Update the event in the calendar
								const calendarEvent = calendar.getEventById(info.event.id);
								calendarEvent.setProp('title', updatedEvents.title);
								calendarEvent.setStart(updatedEvents.start);
								calendarEvent.setEnd(updatedEvents.end);
								calendarEvent.setProp('backgroundColor', updatedEvents.backgroundColor);

								editModal.hide();

							})

						});

						// Delete menu
						menu.querySelector('li:last-child').addEventListener('click', function() {
							const deleteModal = new bootstrap.Modal(document.getElementById('delete-modal'));
							const modalBody = document.getElementById('delete-modal-body');
							const cancelModal = document.getElementById('cancel-button');
							modalBody.innerHTML = `Are you sure you want to delete <b>"${info.event.title}"</b>`
							deleteModal.show();

							const deleteButton = document.getElementById('delete-button');
							deleteButton.addEventListener('click', function () {
								myEvents.splice(eventIndex, 1);
								localStorage.setItem('events', JSON.stringify(myEvents));
								calendar.getEventById(info.event.id).remove();
								deleteModal.hide();
								menu.remove();

							});

							cancelModal.addEventListener('click', function () { 
								deleteModal.hide();
							})

						});
						document.addEventListener('click', function() {
							menu.remove();
						});
					});
				},

				eventDrop: function(info) { 
					let myEvents = JSON.parse(localStorage.getItem('events')) || [];
					const eventIndex = myEvents.findIndex(event => event.id === info.event.id);
					const updatedEvent = {
						...myEvents[eventIndex],
						id: info.event.id, 
						title: info.event.title,
						start: moment(info.event.start).format('YYYY-MM-DD'),
						end: moment(info.event.end).format('YYYY-MM-DD'),
						backgroundColor: info.event.backgroundColor
					};
					myEvents.splice(eventIndex, 1, updatedEvent); // Replace old event data with updated event data
					localStorage.setItem('events', JSON.stringify(myEvents));
					console.log(updatedEvent);
				}

			});

			calendar.on('select', function(info) {

				const startDateInput = document.getElementById('start_date');
				const endDateInput = document.getElementById('end_date');
				startDateInput.value = info.startStr;
				const endDate = moment(info.endStr, 'YYYY-MM-DD').subtract(1, 'day').format('YYYY-MM-DD');
				endDateInput.value = endDate;
				if(startDateInput.value === endDate) {
				endDateInput.value = '';
				}
			});

			calendar.render();

			const form = document.querySelector('form');

			form.addEventListener('submit', function(event) {
				event.preventDefault(); // prevent default form submission

				// retrieve the form input values
				const title = document.querySelector('#event_title').value;
				const startDate = document.querySelector('#start_date').value;
				const endDate = document.querySelector('#end_date').value;
				const color = document.querySelector('#event_color').value;
				const endDateFormatted = moment(endDate, 'YYYY-MM-DD').add(1, 'day').format('YYYY-MM-DD');
				const eventId = uuidv4();

				console.log(eventId);

				if (endDateFormatted <= startDate) { // add if statement to check end date
					dangerAlert.style.display = 'block';
					return;
				}

				const newEvent = {
					id: eventId,
					title: title,
					start: startDate,
					end: endDateFormatted,
					allDay: false,
					backgroundColor: color
				};

				// add the new event to the myEvents array
				//myEvents.push(newEvent);

				// render the new event on the calendar
				calendar.addEvent(newEvent);

				// save events to local storage
				localStorage.setItem('events', JSON.stringify(myEvents));

				eventModal.hide();
				form.reset();
			});

			eventModal._element.addEventListener('hide.modal', function () {
				dangerAlert.style.display = 'none';
				form.reset(); 
			});

		});
    </script>

</body>

</html>